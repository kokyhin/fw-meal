
<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/iron-data-table/iron-data-table.html">

<dom-module id="fw-orders">
  <template>
    <style>
      :host {
        display: block;
        padding: 10px;
      }
    </style>

    <template is="dom-bind">
      <iron-ajax id="getOrders"
        auto
        method="GET"
        url="/api/order/get-orders"
        handle-as="json"
        content-type="application/json"
        on-error="_errorResponse"
        last-response="{{data}}"
      ></iron-ajax>

      <template is='dom-repeat' items='{{data}}'>
        {{item._id}}
        <iron-data-table items="[[item.orders]]">
          <data-table-column name="First Name" filter-by="username">
            <template>[[item.username]]</template>
          </data-table-column>
          <data-table-column name="Last Name">
            <template>[[item.name.last]]</template>
          </data-table-column>
        </iron-data-table>

      </template>

    </template>

  </template>
  <script>
    Polymer({

      is: 'fw-orders',

      _errorResponse: function(ev, res) {
        this.fire('iron-signal', {name:'toast', data: {type: 'error', message: res.request.response.error}});
      }

    });

  </script>
</dom-module>
